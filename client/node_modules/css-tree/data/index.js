var mdnProperties = require('mdn-data/css/properties.json');
var mdnSyntaxes = require('mdn-data/css/syntaxes.json');
var patch = require('./patch.json');
<<<<<<< HEAD

function buildDictionary(dict, patchDict) {
    var result = {};

    // copy all syntaxes for an original dict
    for (var key in dict) {
        result[key] = dict[key].syntax;
    }

    // apply a patch
    for (var key in patchDict) {
        if (key in dict) {
            if (patchDict[key].syntax) {
                result[key] = patchDict[key].syntax;
            } else {
                delete result[key];
            }
        } else {
            if (patchDict[key].syntax) {
                result[key] = patchDict[key].syntax;
            }
        }
    }

    return result;
}

module.exports = {
    properties: buildDictionary(mdnProperties, patch.properties),
    types: buildDictionary(mdnSyntaxes, patch.syntaxes)
};
=======
var data = {
    properties: {},
    types: {}
};

function normalizeSyntax(syntax) {
    return syntax
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>')
        .replace(/&nbsp;/g, ' ')
        .replace(/&amp;/g, '&');
}

function patchDict(dict, patchDict) {
    for (var key in patchDict) {
        if (key in dict) {
            if (patchDict[key].syntax) {
                dict[key].syntax = patchDict[key].syntax;
            } else {
                delete dict[key];
            }
        } else {
            if (patchDict[key].syntax) {
                dict[key] = patchDict[key];
            }
        }
    }
}

// apply patch
patchDict(mdnProperties, patch.properties);
patchDict(mdnSyntaxes, patch.syntaxes);

// normalize source mdnProperties syntaxes, since it uses html token
for (var key in mdnProperties) {
    data.properties[key] = normalizeSyntax(mdnProperties[key].syntax);
}

for (var key in mdnSyntaxes) {
    data.types[key] = normalizeSyntax(mdnSyntaxes[key].syntax);
}

module.exports = data;
>>>>>>> e547b3e77583be3c8de92b6c78317e2fb285a75a
